<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For My Daba</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #ffe6ea; 
            --grid-line: #ffccd5;
            --dark-accent: #5e2a38;
            --btn-bg: #e66b88;
            --white: #ffffff;
        }

        body {
            background-color: var(--bg-color);
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 30px 30px;
            font-family: 'Press Start 2P', cursive;
            color: var(--dark-accent);
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            text-align: center;
            user-select: none;
        }

        #mute-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid var(--dark-accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.1);
        }

        .game-container {
            background: var(--white);
            padding: 1.5rem;
            width: 90%;
            max-width: 380px;
            border: 4px solid var(--dark-accent);
            box-shadow: 8px 8px 0px rgba(94, 42, 56, 0.15);
            border-radius: 4px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto; 
            z-index: 10;
        }
        .game-container::-webkit-scrollbar { display: none; }
        .game-container { -ms-overflow-style: none; scrollbar-width: none; }

        .falling-element {
            position: fixed;
            top: -50px;
            font-size: 20px;
            color: #ff4d6d;
            z-index: 5;
            pointer-events: none;
            animation: fall linear forwards;
        }

        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
        }

        .carousel-container {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 10px;
            padding-bottom: 10px;
            margin: 15px 0;
            -webkit-overflow-scrolling: touch; 
        }
        .carousel-container::-webkit-scrollbar { display: none; }

        .carousel-item {
            flex: 0 0 100%; 
            width: 100%;
            scroll-snap-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .carousel-img {
            max-width: 100%;
            max-height: 80vh; 
            object-fit: cover;
            border: 2px solid var(--dark-accent);
            border-radius: 8px;
            background-color: #eee;
            image-rendering: auto;
        }

        .carousel-placeholder {
            width: 100%;
            height: 80vh;
            background: #eee;
            border: 2px solid var(--dark-accent);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #ccc;
        }

        .selection-box {
            margin-top: 10px;
            background: #fff0f5;
            border: 2px solid var(--dark-accent);
            padding: 10px;
            width: 90%;
            border-radius: 4px;
        }

        .selection-label {
            font-size: 0.7rem;
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }

        #other-input {
            font-family: 'Press Start 2P', cursive;
            width: 85%;
            padding: 8px;
            margin: 5px 0;
            font-size: 0.55rem;
            border: 2px solid var(--dark-accent);
            background: #fff;
            color: var(--dark-accent);
            text-align: center;
        }
        #other-input:focus { outline: none; background: #fffbe6; }

        input[type="radio"] {
            accent-color: var(--btn-bg);
            transform: scale(1.5);
            cursor: pointer;
        }

        .pixel-heart {
            font-size: 2.5rem;
            color: #ff4d6d;
            cursor: pointer;
            animation: beat 0.8s infinite alternate;
            margin-top: 15px;
            display: inline-block;
            text-shadow: 2px 2px 0px var(--dark-accent);
        }

        @keyframes beat { to { transform: scale(1.1); } }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }

        button {
            font-family: 'Press Start 2P', cursive;
            padding: 12px 15px;
            background: var(--btn-bg);
            color: white;
            border: 2px solid var(--dark-accent);
            box-shadow: 3px 3px 0px var(--dark-accent);
            cursor: pointer;
            font-size: 0.7rem;
            text-transform: uppercase;
        }

        button:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0px var(--dark-accent);
        }

        .back-btn {
            background: transparent;
            color: var(--dark-accent);
            box-shadow: none;
            border: none;
            text-decoration: underline;
            font-size: 0.6rem;
            margin-top: 10px;
        }

        .quest-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            width: 100%;
            margin-top: 10px;
        }
        
        .quest-item {
            border: 2px solid var(--dark-accent);
            padding: 15px 5px;
            background: #fff5f7;
            cursor: pointer;
            transition: 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
        }

        .quest-item:hover { background: #ffe0e6; transform: translateY(-2px); }
        .quest-item.full-width { grid-column: span 2; } 
        .quest-icon { font-size: 1.8rem; margin-bottom: 8px; display: block; }

        .finish-container {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }
        
        .finish-btn-small {
            font-size: 0.5rem;
            padding: 8px 12px;
            background: #aaa;
            border: 2px solid var(--dark-accent);
            box-shadow: 2px 2px 0 var(--dark-accent);
        }

        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 300px; }
        .screen.active { display: flex; animation: fadeIn 0.5s; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        h1 { font-size: 1.2rem; line-height: 1.4; margin-bottom: 15px; }
        p { font-size: 0.7rem; line-height: 1.6; margin-bottom: 15px; }
        
        @keyframes slideUpSlow { 
            0% { transform: translateY(100vh); opacity: 0; } 
            100% { transform: translateY(0); opacity: 1; } 
        }

        .error-shake { animation: shake 0.4s; color: red; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        .scroll-hint { font-size: 0.5rem; opacity: 0.6; margin-bottom: 5px; }
    </style>
</head>
<body>

    <button id="mute-btn" onclick="toggleMute()">üîä</button>

    <audio id="bgm" loop>
        <source src="bgm1.mp3" type="audio/mp3">
    </audio>
    <audio id="bgm-love" loop>
        <source src="bgm2.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx">
        <source src="https://www.soundjay.com/buttons/sounds/button-20.mp3" type="audio/mp3">
    </audio>

    <div class="game-container">
        
        <div id="screen-0" class="screen active">
            <h1>Hi Daba! <br>üíñ</h1>
            <p style="font-size:0.6rem">click start to begin</p>
            <div class="pixel-heart" onclick="startGame()">START</div>
        </div>

        <div id="screen-1" class="screen">
            <p style="font-size:0.9rem">Today is the</p>
            <h1>28th Day of the Month</h1>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>

        <div id="screen-2" class="screen">
            <h1 style="color: #e66b88;">Happy 2nd Monthsary, my love.</h1>
            <p>(Kahit na parang 2 years na talaga)</p>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>

        <div id="screen-3" class="screen">
            <h1>But wait...</h1>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>
        <div id="screen-4" class="screen">
            <h1>there's more</h1>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>
        <div id="screen-5" class="screen">
            <h1>Valentine's Day is coming up</h1>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>
        <div id="screen-6" class="screen">
            <h1>And I'l like to take this moment<br>to formally ask...</h1>
            <div class="pixel-heart" onclick="nextScreen()">NEXT</div>
        </div>

        <div id="screen-7" class="screen">
            <h1>Will you be my Valentine's Date? ü•∫</h1>
            <div class="btn-group">
                <button id="btn-yes" onclick="handleYes()">YES!</button>
                <button id="btn-no" onclick="handleNo()">NO</button>
            </div>
            <p id="no-msg" style="margin-top:15px; height: 20px; font-size: 0.6rem; color:red;"></p>
        </div>

        <div id="screen-8" class="screen">
            <h1 style="color: var(--btn-bg);">YEYYY!! <br>I LOVE YOUUUHUNUNUUN!üò≠üíñ</h1>
            <p style="font-size:0.5rem">Here's a little something...</p>
   
            <button onclick="nextScreen()">CLICK FOR DETAILS</button>
        </div>

        <div id="screen-9" class="screen">
            <h1>PICK A QUEST</h1>
            <div class="quest-grid">
                <div class="quest-item" onclick="showDetail('hotel')">
                    <span class="quest-icon">üè®</span>
                    AIRBNB
                </div>
                <div class="quest-item" onclick="showDetail('dinner')">
                    <span class="quest-icon">üçΩÔ∏è</span>
                    LUNCH
                </div>
                <div class="quest-item full-width" onclick="showDetail('letter')">
                    <span class="quest-icon">üíå</span>
                    For my Daba ‚ù§
                </div>
            </div>
            
            <div class="finish-container">
                <button class="finish-btn-small" onclick="showEnding()">üèÅ End</button>
            </div>
        </div>

        <div id="detail-hotel" class="screen">
            <h1>üè® Where We'll Stay</h1>
            <p class="scroll-hint"><< Swipe photos >></p>
            <div class="carousel-container">
                <div class="carousel-item">
                    <img src="bnb1.jpg" class="carousel-img">
                </div>
                <div class="carousel-item">
                    <img src="bnb2.jpg" class="carousel-img">
                </div>

                <div class="carousel-item">
                    <img src="bnb3.jpg" class="carousel-img">
                </div>

                <div class="carousel-item">
                    <img src="bnb4.jpg" class="carousel-img">
                </div>

            </div>
            <p style="font-size:0.7rem">Location: The Lair Elyu<br>Check-inTime: 2:00 PM</p>
            <button class="back-btn" onclick="goToMenu()">BACK TO MENU</button>
        </div>

        <div id="detail-dinner" class="screen">
            <h1>üçΩÔ∏è Lunch Date</h1>
            <p class="scroll-hint"><< Swipe and select >></p>
            
            <div class="carousel-container">
                <div class="carousel-item">
                    <img src="canggu.jpg" class="carousel-img">
                    <div class="selection-box">
                        <span class="selection-label">Little Canggu</span>
                        <label>
                            <input type="radio" name="dinner-choice" value="Little Canggu" onchange="selectDinner(this.value)"> 
                            SELECT
                        </label>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="patio.jpg" class="carousel-img">
                    <div class="selection-box">
                        <span class="selection-label">Patio by Balai Norte</span>
                        <label>
                            <input type="radio" name="dinner-choice" value="Patio by Balai Norte" onchange="selectDinner(this.value)"> 
                            SELECT
                        </label>
                    </div>
                </div>
         
                <div class="carousel-item">
                    <div class="carousel-placeholder">‚ùì</div>
                    <div class="selection-box">
                        <span class="selection-label">Something else?</span>
                        <input type="text" id="other-input" placeholder="Type here..." oninput="updateOther(this.value)">
                        <label>
                            <input type="radio" id="other-radio" name="dinner-choice" value="Other" onchange="selectDinner('Other')"> 
                            SELECT
                        </label>
                    </div>
                </div>
            </div>

            <button class="back-btn" onclick="goToMenu()">BACK TO MENU</button>
        </div>

        <div id="detail-letter" class="screen">
            <h1>üíå For You</h1>
           
            <div class="carousel-container">
                <div class="carousel-item">
                    <img src="elyu.jpg" class="carousel-img">
                </div>
               
            </div>
            <div style="background:#fff5f7; border:2px dashed var(--dark-accent); padding:15px; font-size:0.6rem; text-align:left; width: 100%; box-sizing: border-box;">
                Dear Daba,<br><br>
                Tara let's go back to the corner where I first saw you~~<br><br>Elyu will always hold a special place in my heart because of you. Let's go back for a special Valentine's day.<br><br>
                Love,<br>K.
            </div>
            <button class="back-btn" onclick="goToMenu()">BACK TO MENU</button>
        </div>

        <div id="detail-end" class="screen">
            <h1 style="font-size: 2rem;">Save the Date</h1>
            
            <div style="background:#fff0f5; border: 4px double var(--dark-accent); padding: 15px; margin: 20px 0;">
                <p style="font-weight:bold; color: var(--btn-bg);">I can't wait to spend Valentine's with you</p>
                <p style="font-size: 1rem;">FEBRUARY 13-14, 2026<br>ELYU</p>
                <hr style="border: 1px dashed var(--dark-accent); margin: 10px 0;">
                <p style="font-size: 0.6rem;">SELECTED LUNCH LOCATION:</p>
                <p id="final-restaurant" style="font-weight:bold; font-size: 0.9rem;">N/A</p>
            </div>

            <div class="pixel-heart" style="cursor: default;">üíæ</div>
            <p style="font-size: 0.5rem; margin-top: 30px;">I love you!</p>
        </div>

    </div>

    <div id="falling-container"></div>

    <script>
        let currentScreen = 0;
        const totalScreens = 10; 
        const noTexts = ["Di mo ko lab?", "Are you sure?", "Pls don't :(", "Click YES!", "Last chance!", "Grabe ka!", "Huhu üò≠"];
        let noCount = 0;
        let fallInterval; 
        let isMuted = false;
        
        // --- CHANGED: Default is empty to enforce selection
        let selectedRestaurantName = ""; 

        const bgm = document.getElementById('bgm');
        const bgmLove = document.getElementById('bgm-love'); 
        const sfx = document.getElementById('sfx');
        bgm.volume = 0.3; bgmLove.volume = 0.3; sfx.volume = 0.6;

        function playClick() { sfx.currentTime = 0; sfx.play(); }

        function toggleMute() {
            const btn = document.getElementById('mute-btn');
            isMuted = !isMuted; 
            if (isMuted) { bgm.pause(); bgmLove.pause(); btn.innerText = "üîá"; } 
            else { btn.innerText = "üîä"; if (currentScreen >= 8) bgmLove.play(); else bgm.play(); }
        }

        function startGame() {
            playClick();
            if(!isMuted) bgm.play().catch(e => console.log(e));
            nextScreen();
        }

        function showScreen(index) {
            document.querySelectorAll('.screen').forEach(s => { s.classList.remove('active'); s.style.animation = 'none'; });
            
            stopFallingAnimation();

            if (index === 2) startFallingHearts(); 

            const target = document.getElementById(`screen-${index}`);
            if(target) {
                target.classList.add('active'); 
                if(index === 7) { void target.offsetWidth; target.style.animation = "slideUpSlow 3s ease-out forwards"; }
                else { target.style.animation = "fadeIn 0.5s ease forwards"; }
            }
        }

        function nextScreen() {
            if(currentScreen > 0) playClick(); 
            currentScreen++;
            if (currentScreen < totalScreens) showScreen(currentScreen);
        }

        function startFallingHearts() {
            clearInterval(fallInterval);
            const container = document.getElementById('falling-container');
            fallInterval = setInterval(() => {
                const el = document.createElement('div');
                el.classList.add('falling-element');
                el.innerText = Math.random() > 0.5 ? 'üíñ' : 'üéâ';
                el.style.left = Math.random() * 100 + 'vw'; 
                el.style.animationDuration = (Math.random() * 2 + 2) + 's'; 
                el.style.fontSize = (Math.random() * 20 + 10) + 'px'; 
                container.appendChild(el);
                setTimeout(() => { el.remove(); }, 4000);
            }, 300);
        }

        function startConfetti() {
            clearInterval(fallInterval);
            const container = document.getElementById('falling-container');
            const confettiMix = ['‚ú®', 'üéâ', 'üéä', 'üéÄ', 'üéà', 'üíñ'];
            fallInterval = setInterval(() => {
                const el = document.createElement('div');
                el.classList.add('falling-element');
                el.innerText = confettiMix[Math.floor(Math.random() * confettiMix.length)];
                el.style.left = Math.random() * 100 + 'vw'; 
                el.style.animationDuration = (Math.random() * 1.5 + 1.5) + 's'; 
                el.style.fontSize = (Math.random() * 15 + 15) + 'px'; 
                container.appendChild(el);
                setTimeout(() => { el.remove(); }, 4000);
            }, 150); 
        }

        function stopFallingAnimation() {
            clearInterval(fallInterval);
            document.getElementById('falling-container').innerHTML = ''; 
        }

        function handleNo() {
            playClick();
            const noMsg = document.getElementById('no-msg');
            const yesBtn = document.getElementById('btn-yes');
            noMsg.innerText = noTexts[noCount % noTexts.length];
            noMsg.classList.remove('error-shake');
            void noMsg.offsetWidth; 
            noMsg.classList.add('error-shake');
            
            let currentSize = parseFloat(window.getComputedStyle(yesBtn).fontSize);
            yesBtn.style.fontSize = (currentSize + 3) + 'px';
            yesBtn.style.padding = (parseInt(yesBtn.style.padding || 12) + 2) + 'px';
            noCount++;
        }

        function handleYes() { 
            playClick();
            bgm.pause(); bgm.currentTime = 0;
            if(!isMuted) bgmLove.play();
            nextScreen(); 
        }

        function selectDinner(val) {
            playClick();
            if(val === "Other") {
                const inputVal = document.getElementById('other-input').value;
                selectedRestaurantName = inputVal || "Her Suggestion";
            } else {
                selectedRestaurantName = val;
            }
        }

        function updateOther(val) {
            document.getElementById('other-radio').checked = true;
            // Handle if she clears the text input
            if(val.trim() === "") {
                 selectedRestaurantName = ""; // Reset to empty if deleted
            } else {
                 selectedRestaurantName = val;
            }
        }

        function showDetail(type) {
            playClick();
            document.querySelectorAll('.screen').forEach(s => { s.classList.remove('active'); s.style.animation = 'none'; });
            
            if(type !== 'end') stopFallingAnimation();

            const detail = document.getElementById(`detail-${type}`);
            detail.classList.add('active');
            detail.style.animation = "fadeIn 0.5s ease forwards";
        }

        // --- UPDATED: VALIDATION CHECK ---
        function showEnding() {
            playClick();
            
            // 1. Check if selection is empty
            if(!selectedRestaurantName || selectedRestaurantName === "") {
                alert("‚ö†Ô∏è SYSTEM ALERT:\nPlease select a lunch location first!");
                // Redirect to dinner page
                showDetail('dinner');
                return; // Stop execution
            }

            // 2. If valid, show ending
            document.getElementById('final-restaurant').innerText = selectedRestaurantName;
            showDetail('end'); 
            startConfetti();
        }

        function goToMenu() {
            playClick();
            document.querySelectorAll('.screen').forEach(s => { s.classList.remove('active'); s.style.animation = 'none'; });
            stopFallingAnimation();
            const menu = document.getElementById('screen-9');
            menu.classList.add('active');
            menu.style.animation = "fadeIn 0.5s ease forwards";
        }
    </script>
</body>
</html>